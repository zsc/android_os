<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="./">
    <title>ç¬¬9ç« ï¼šContentProviderä¸æ•°æ®å…±äº«</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>ç›®å½•</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="æœç´¢..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-item " >
                        <a href="index.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Android OS æ·±åº¦åŸç†è§£æ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter1.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬1ç« ï¼šAndroidç³»ç»Ÿæ¶æ„æ¦‚è§ˆ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter2.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬2ç« ï¼šLinuxå†…æ ¸å±‚å®šåˆ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter3.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬3ç« ï¼šç¡¬ä»¶æŠ½è±¡å±‚(HAL)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter4.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬4ç« ï¼šInitè¿›ç¨‹ä¸ç³»ç»Ÿå¯åŠ¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter5.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬5ç« ï¼šZygoteä¸åº”ç”¨è¿›ç¨‹ç®¡ç†</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter6.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬6ç« ï¼šAndroid Runtime (ART)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter7.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬7ç« ï¼šBinder IPCæœºåˆ¶æ·±åº¦å‰–æ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter8.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬8ç« ï¼šç³»ç»ŸæœåŠ¡æ¶æ„</span>
                        </a>
                    </div>
                
                    <div class="tree-item active" >
                        <a href="chapter9.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬9ç« ï¼šContentProviderä¸æ•°æ®å…±äº«</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter10.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬10ç« ï¼šAndroidå›¾å½¢ç³»ç»Ÿæ¶æ„</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter11.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬11ç« ï¼šéŸ³é¢‘ç³»ç»Ÿæ¶æ„</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter12.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬12ç« ï¼šç›¸æœºä¸å¤šåª’ä½“æ¡†æ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter13.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬13ç« ï¼šAndroidå®‰å…¨æ¨¡å‹</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter14.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬14ç« ï¼šå¯†é’¥ç®¡ç†ä¸ç¡¬ä»¶å®‰å…¨</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter15.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬15ç« ï¼šæ¼æ´æ¡ˆä¾‹åˆ†æ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter16.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬16ç« ï¼šNeural Networks API (NNAPI)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter17.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬17ç« ï¼šTensorFlow Liteé›†æˆ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter18.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬18ç« ï¼šML Kitä¸è®¾å¤‡ç«¯AI</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter19.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬19ç« ï¼šNPU/TPUç¡¬ä»¶åŠ é€Ÿ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter20.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬20ç« ï¼šåå¤„ç†å™¨ç³»ç»Ÿé›†æˆ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter21.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬21ç« ï¼šMIUIç³»ç»Ÿæ¶æ„å‰–æ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter22.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬22ç« ï¼šColorOS/EMUIæŠ€æœ¯åˆ†æ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter23.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬23ç« ï¼šå‚å•†å†…æ ¸ä¸é©±åŠ¨å®šåˆ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter24.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬24ç« ï¼šå‚å•†AIèƒ½åŠ›å¯¹æ¯”</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter25.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬25ç« ï¼šOriginOSæ·±åº¦å‰–æ</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter26.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬26ç« ï¼šAndroidè™šæ‹ŸåŒ–æŠ€æœ¯</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter27.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬27ç« ï¼šå®æ—¶æ€§ä¸æ€§èƒ½ä¼˜åŒ–</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter28.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬28ç« ï¼šé€†å‘å·¥ç¨‹ä¸å®‰å…¨ç ”ç©¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter29.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬29ç« ï¼šAndroidæœªæ¥æ¼”è¿›</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter30.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é™„å½•Aï¼šè°ƒè¯•å·¥å…·ä¸æŠ€å·§</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter31.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">é™„å½•Bï¼šæºç ç¼–è¯‘ä¸å®šåˆ¶</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter32.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">ç¬¬32ç« ï¼šå‚è€ƒèµ„æº</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="CLAUDE.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">AndroidOSåŸç†æ•™ç¨‹é¡¹ç›®è¯´æ˜</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="README.html" class="tree-link">
                            <span class="tree-icon">ğŸ“„</span>
                            <span class="tree-title">Android OS æ·±åº¦åŸç†è§£æ</span>
                        </a>
                    </div>
                </nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="9contentprovider">ç¬¬9ç« ï¼šContentProviderä¸æ•°æ®å…±äº«</h1>
<p>åœ¨Androidç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œåº”ç”¨é—´çš„æ•°æ®å…±äº«æ˜¯ä¸€ä¸ªæ ¸å¿ƒéœ€æ±‚ã€‚ContentProviderä½œä¸ºAndroidå››å¤§ç»„ä»¶ä¹‹ä¸€ï¼Œæä¾›äº†ä¸€å¥—æ ‡å‡†åŒ–ã€å®‰å…¨çš„è·¨è¿›ç¨‹æ•°æ®è®¿é—®æœºåˆ¶ã€‚æœ¬ç« å°†æ·±å…¥å‰–æContentProviderçš„å®ç°åŸç†ï¼Œæ¢è®¨å…¶ç‹¬ç‰¹çš„URIæƒé™æ¨¡å‹ï¼Œåˆ†ææ•°æ®å˜æ›´é€šçŸ¥æœºåˆ¶ï¼Œå¹¶ä¸iOSçš„æ•°æ®å…±äº«æ–¹æ¡ˆè¿›è¡Œå¯¹æ¯”ã€‚é€šè¿‡æœ¬ç« å­¦ä¹ ï¼Œè¯»è€…å°†æŒæ¡Androidæ•°æ®å…±äº«çš„åº•å±‚æœºåˆ¶ï¼Œç†è§£å…¶è®¾è®¡æƒè¡¡ï¼Œå¹¶èƒ½å¤Ÿè®¾è®¡é«˜æ•ˆã€å®‰å…¨çš„æ•°æ®å…±äº«æ–¹æ¡ˆã€‚</p>
<h2 id="_1">å­¦ä¹ ç›®æ ‡</h2>
<ul>
<li>ç†è§£ContentProvideråœ¨Androidæ¶æ„ä¸­çš„å®šä½å’Œè®¾è®¡ç†å¿µ</li>
<li>æŒæ¡ContentProviderçš„åº•å±‚å®ç°æœºåˆ¶å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
<li>æ·±å…¥ç†è§£URIæƒé™æ¨¡å‹åŠå…¶å®‰å…¨æ€§ä¿è¯</li>
<li>æŒæ¡æ•°æ®å˜æ›´é€šçŸ¥çš„å®ç°åŸç†å’Œä¼˜åŒ–ç­–ç•¥</li>
<li>å¯¹æ¯”åˆ†æAndroidä¸iOSçš„æ•°æ®å…±äº«æœºåˆ¶å·®å¼‚</li>
<li>è¯†åˆ«ContentProviderä½¿ç”¨ä¸­çš„å¸¸è§é™·é˜±å’Œå®‰å…¨é£é™©</li>
</ul>
<h2 id="91-contentprovider">9.1 ContentProvideræ¶æ„æ¦‚è¿°</h2>
<h3 id="911">9.1.1 è®¾è®¡ç†å¿µä¸å†å²æ¼”è¿›</h3>
<p>ContentProviderçš„è®¾è®¡æºäºAndroidæ—©æœŸå¯¹ç»“æ„åŒ–æ•°æ®å…±äº«çš„éœ€æ±‚ã€‚ä¸ä¼ ç»Ÿçš„æ–‡ä»¶å…±äº«ä¸åŒï¼ŒContentProvideræä¾›äº†ç±»ä¼¼æ•°æ®åº“çš„æ¥å£ï¼Œæ”¯æŒç»“æ„åŒ–æŸ¥è¯¢å’Œæ‰¹é‡æ“ä½œã€‚</p>
<p>åœ¨Androidçš„æ¼”è¿›è¿‡ç¨‹ä¸­ï¼ŒContentProviderç»å†äº†å‡ ä¸ªé‡è¦é˜¶æ®µï¼š</p>
<ol>
<li><strong>Android 1.0-2.3</strong>ï¼šåŸºç¡€CRUDæ“ä½œï¼Œç®€å•çš„URIæƒé™æ¨¡å‹</li>
<li><strong>Android 3.0(Honeycomb)</strong>ï¼šå¼•å…¥CursorLoaderï¼Œæ”¯æŒå¼‚æ­¥æ•°æ®åŠ è½½</li>
<li><strong>Android 4.0(ICS)</strong>ï¼šå¢å¼ºæ‰¹é‡æ“ä½œæ”¯æŒï¼Œå¼•å…¥ContentProviderOperation</li>
<li><strong>Android 5.0(Lollipop)</strong>ï¼šæ”¹è¿›æƒé™æ¨¡å‹ï¼Œæ”¯æŒæ›´ç»†ç²’åº¦çš„URIæƒé™</li>
<li><strong>Android 7.0(Nougat)</strong>ï¼šFileProvideræˆä¸ºæ–‡ä»¶å…±äº«çš„æ¨èæ–¹å¼</li>
<li><strong>Android 10(Q)</strong>ï¼šä½œç”¨åŸŸå­˜å‚¨(Scoped Storage)å¯¹MediaProviderçš„å½±å“</li>
</ol>
<h3 id="912-android">9.1.2 åœ¨Androidæ•°æ®å…±äº«ä½“ç³»ä¸­çš„åœ°ä½</h3>
<p>ContentProvideråœ¨Androidæ•°æ®å…±äº«ä½“ç³»ä¸­æ‰®æ¼”ç€æ ¸å¿ƒè§’è‰²ï¼š</p>
<div class="codehilite"><pre><span></span><code>åº”ç”¨å±‚æ•°æ®å…±äº«ä½“ç³»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Application Layer              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  App A  â”‚  â”‚  App B  â”‚  â”‚  App C  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚            â”‚            â”‚       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â” â”‚
â”‚  â”‚      ContentResolver API          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Framework Layerâ”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    ContentProvider Transport      â”‚ â”‚
â”‚  â”‚  (ActivityManagerServiceåè°ƒ)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚        Binder IPC Layer           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>ContentProviderçš„ç‹¬ç‰¹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>æ ‡å‡†åŒ–æ¥å£</strong>ï¼šç»Ÿä¸€çš„CRUDæ“ä½œæ¥å£</li>
<li><strong>æƒé™ç®¡ç†</strong>ï¼šç»†ç²’åº¦çš„URIçº§åˆ«æƒé™æ§åˆ¶</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šç”±ç³»ç»Ÿç®¡ç†Providerè¿›ç¨‹çš„å¯åŠ¨å’Œé”€æ¯</li>
<li><strong>æ•°æ®ç±»å‹æŠ½è±¡</strong>ï¼šæ”¯æŒç»“æ„åŒ–æ•°æ®ã€æ–‡ä»¶ã€æµç­‰å¤šç§æ•°æ®ç±»å‹</li>
</ul>
<h2 id="92-contentprovider">9.2 ContentProviderå®ç°åŸç†</h2>
<h3 id="921">9.2.1 è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶</h3>
<p>ContentProviderçš„è·¨è¿›ç¨‹é€šä¿¡å»ºç«‹åœ¨Binderæœºåˆ¶ä¹‹ä¸Šï¼Œä½†åœ¨å…¶ä¸Šå±‚æä¾›äº†æ›´é«˜çº§çš„æŠ½è±¡ã€‚</p>
<div class="codehilite"><pre><span></span><code>ContentProvider IPCæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client App â”‚     â”‚ ActivityManager  â”‚     â”‚Provider App â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                      â”‚
       â”‚ getContentResolver()â”‚                      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                      â”‚
       â”‚                     â”‚                      â”‚
       â”‚ query(uri,...)      â”‚                      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                      â”‚
       â”‚                     â”‚ æ£€æŸ¥Provideræ˜¯å¦è¿è¡Œ  â”‚
       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ å¦‚éœ€è¦ï¼Œå¯åŠ¨Provider â”‚
       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ è·å–IContentProvider â”‚
       â”‚                     â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                     â”‚                      â”‚
       â”‚ IContentProviderå¼•ç”¨â”‚                      â”‚
       â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
       â”‚                     â”‚                      â”‚
       â”‚ ç›´æ¥Binderè°ƒç”¨       â”‚                      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚      æ‰§è¡Œquery()     â”‚
       â”‚                     â”‚                      â”‚
       â”‚ Cursorç»“æœ          â”‚                      â”‚
       â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
</code></pre></div>

<p>å…³é”®å®ç°ç»†èŠ‚ï¼š</p>
<ol>
<li>
<p><strong>IContentProvideræ¥å£</strong>ï¼šå®šä¹‰äº†è·¨è¿›ç¨‹è°ƒç”¨çš„AIDLæ¥å£
   - <code>query()</code>, <code>insert()</code>, <code>update()</code>, <code>delete()</code>
   - <code>bulkInsert()</code>, <code>applyBatch()</code>
   - <code>openFile()</code>, <code>openAssetFile()</code></p>
</li>
<li>
<p><strong>ContentProviderNative</strong>ï¼šIContentProviderçš„æœ¬åœ°å®ç°
   - å¤„ç†Binderä¼ è¾“çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–
   - ç®¡ç†è·¨è¿›ç¨‹çš„Cursorä¼ è¾“</p>
</li>
<li>
<p><strong>Transportç±»</strong>ï¼šContentProviderçš„å†…éƒ¨ç±»
   - å®ç°IContentProvideræ¥å£
   - å°†Binderè°ƒç”¨è½¬å‘åˆ°ContentProviderå®ä¾‹æ–¹æ³•</p>
</li>
</ol>
<h3 id="922-contentprovider">9.2.2 ContentProviderç”Ÿå‘½å‘¨æœŸ</h3>
<p>ContentProviderçš„ç”Ÿå‘½å‘¨æœŸç”±ç³»ç»Ÿä¸¥æ ¼ç®¡ç†ï¼š</p>
<div class="codehilite"><pre><span></span><code>ç”Ÿå‘½å‘¨æœŸçŠ¶æ€è½¬æ¢ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœªåˆ›å»º    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚ é¦–æ¬¡è®¿é—®
      v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  onCreate â”‚â”€â”€â”€â”€â”€â”€&gt; åˆå§‹åŒ–æ•°æ®åº“ã€ç¼“å­˜ç­‰
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚
      v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ´»è·ƒ     â”‚&lt;â”€â”€â”€â”€&gt; å¤„ç†CRUDè¯·æ±‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
      â”‚ è¿›ç¨‹è¢«æ€
      v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   é”€æ¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>é‡è¦ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>æ‡’åŠ è½½</strong>ï¼šProviderè¿›ç¨‹ä»…åœ¨é¦–æ¬¡è®¿é—®æ—¶å¯åŠ¨</li>
<li><strong>è¿›ç¨‹ä¼˜å…ˆçº§</strong>ï¼šæŒæœ‰Providerçš„è¿›ç¨‹ä¼˜å…ˆçº§æå‡</li>
<li><strong>å¤šçº¿ç¨‹å¤„ç†</strong>ï¼šç³»ç»Ÿè‡ªåŠ¨åœ¨çº¿ç¨‹æ± ä¸­å¤„ç†è¯·æ±‚</li>
</ul>
<h3 id="923">9.2.3 æŸ¥è¯¢æ“ä½œçš„åº•å±‚å®ç°</h3>
<p>æŸ¥è¯¢æ“ä½œæ˜¯ContentProvideræœ€å¤æ‚çš„æ“ä½œï¼Œæ¶‰åŠè·¨è¿›ç¨‹çš„Cursorä¼ è¾“ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ContentProviderç«¯å®ç°</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Cursor</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">projection</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">String</span><span class="w"> </span><span class="n">selection</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">selectionArgs</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">String</span><span class="w"> </span><span class="n">sortOrder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. URIåŒ¹é…å’Œæƒé™æ£€æŸ¥</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sUriMatcher</span><span class="p">.</span><span class="na">match</span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. æ„å»ºæŸ¥è¯¢</span>
<span class="w">    </span><span class="n">SQLiteQueryBuilder</span><span class="w"> </span><span class="n">qb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SQLiteQueryBuilder</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 3. æ‰§è¡ŒæŸ¥è¯¢</span>
<span class="w">    </span><span class="n">Cursor</span><span class="w"> </span><span class="n">cursor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qb</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="n">db</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="p">,</span><span class="w"> </span><span class="n">selection</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">selectionArgs</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="n">sortOrder</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. è®¾ç½®é€šçŸ¥URI</span>
<span class="w">    </span><span class="n">cursor</span><span class="p">.</span><span class="na">setNotificationUri</span><span class="p">(</span><span class="n">getContext</span><span class="p">().</span><span class="na">getContentResolver</span><span class="p">(),</span><span class="w"> </span><span class="n">uri</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">cursor</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>è·¨è¿›ç¨‹Cursorä¼ è¾“æœºåˆ¶ï¼š</p>
<ol>
<li>
<p><strong>CursorWindow</strong>ï¼šå…±äº«å†…å­˜çª—å£
   - é»˜è®¤å¤§å°2MBï¼ˆå¯é…ç½®ï¼‰
   - ä½¿ç”¨ashmemï¼ˆåŒ¿åå…±äº«å†…å­˜ï¼‰
   - æ”¯æŒåˆ†é¡µåŠ è½½å¤§æ•°æ®é›†</p>
</li>
<li>
<p><strong>BulkCursorToCursorAdaptor</strong>ï¼šå®¢æˆ·ç«¯é€‚é…å™¨
   - ç®¡ç†è¿œç¨‹Cursorå¼•ç”¨
   - å¤„ç†æ•°æ®çª—å£çš„è·å–å’Œç¼“å­˜
   - å®ç°æœ¬åœ°Cursoræ¥å£</p>
</li>
</ol>
<h3 id="924">9.2.4 æ‰¹é‡æ“ä½œä¸äº‹åŠ¡æ”¯æŒ</h3>
<p>ContentProvideræ”¯æŒé«˜æ•ˆçš„æ‰¹é‡æ“ä½œï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// æ‰¹é‡æ“ä½œå®ç°</span>
<span class="kd">public</span><span class="w"> </span><span class="n">ContentProviderResult</span><span class="o">[]</span><span class="w"> </span><span class="nf">applyBatch</span><span class="p">(</span>
<span class="w">        </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">ContentProviderOperation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">operations</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">OperationApplicationException</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numOperations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">operations</span><span class="p">.</span><span class="na">size</span><span class="p">();</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">ContentProviderResult</span><span class="o">[]</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">ContentProviderResult</span><span class="o">[</span><span class="n">numOperations</span><span class="o">]</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// å¼€å¯äº‹åŠ¡</span>
<span class="w">    </span><span class="n">db</span><span class="p">.</span><span class="na">beginTransaction</span><span class="p">();</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numOperations</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">results</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">operations</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="na">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">results</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">db</span><span class="p">.</span><span class="na">setTransactionSuccessful</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">db</span><span class="p">.</span><span class="na">endTransaction</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">results</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<ul>
<li><strong>æ‰¹é‡æ’å…¥ä¼˜åŒ–</strong>ï¼š<code>bulkInsert()</code>é¿å…å¤šæ¬¡è·¨è¿›ç¨‹è°ƒç”¨</li>
<li><strong>äº‹åŠ¡æ‰¹å¤„ç†</strong>ï¼šå‡å°‘æ•°æ®åº“é”ç«äº‰</li>
<li><strong>å»¶è¿Ÿé€šçŸ¥</strong>ï¼šæ‰¹é‡æ“ä½œå®Œæˆåç»Ÿä¸€å‘é€é€šçŸ¥</li>
</ul>
<h2 id="93-uri">9.3 URIæƒé™æ¨¡å‹</h2>
<h3 id="931-uri">9.3.1 URIç»“æ„ä¸è§£ææœºåˆ¶</h3>
<p>Androidçš„Content URIéµå¾ªæ ‡å‡†æ ¼å¼ï¼š</p>
<div class="codehilite"><pre><span></span><code>content://authority/path/id
   â”‚         â”‚        â”‚   â”‚
   â”‚         â”‚        â”‚   â””â”€â”€ å¯é€‰çš„è¡ŒID
   â”‚         â”‚        â””â”€â”€â”€â”€â”€â”€ æ•°æ®è·¯å¾„
   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Provideræˆæƒæ ‡è¯†
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å›ºå®šscheme
</code></pre></div>

<p>URIè§£æå’ŒåŒ¹é…ä½¿ç”¨UriMatcherï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// URIåŒ¹é…å™¨é…ç½®</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">UriMatcher</span><span class="w"> </span><span class="n">sUriMatcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UriMatcher</span><span class="p">(</span><span class="n">UriMatcher</span><span class="p">.</span><span class="na">NO_MATCH</span><span class="p">);</span>
<span class="kd">static</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sUriMatcher</span><span class="p">.</span><span class="na">addURI</span><span class="p">(</span><span class="n">AUTHORITY</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;items&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ITEMS</span><span class="p">);</span>
<span class="w">    </span><span class="n">sUriMatcher</span><span class="p">.</span><span class="na">addURI</span><span class="p">(</span><span class="n">AUTHORITY</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;items/#&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_ID</span><span class="p">);</span>
<span class="w">    </span><span class="n">sUriMatcher</span><span class="p">.</span><span class="na">addURI</span><span class="p">(</span><span class="n">AUTHORITY</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;items/*/details&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ITEM_DETAILS</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="932">9.3.2 æƒé™æˆäºˆä¸æ’¤é”€</h3>
<p>ContentProvideræä¾›äº†çµæ´»çš„æƒé™æ¨¡å‹ï¼š</p>
<ol>
<li><strong>é™æ€æƒé™å£°æ˜</strong>ï¼ˆAndroidManifest.xmlï¼‰ï¼š</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;provider</span>
<span class="w">    </span><span class="na">android:name=</span><span class="s">&quot;.MyProvider&quot;</span>
<span class="w">    </span><span class="na">android:authorities=</span><span class="s">&quot;com.example.provider&quot;</span>
<span class="w">    </span><span class="na">android:readPermission=</span><span class="s">&quot;com.example.READ_DATA&quot;</span>
<span class="w">    </span><span class="na">android:writePermission=</span><span class="s">&quot;com.example.WRITE_DATA&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;path-permission</span>
<span class="w">        </span><span class="na">android:pathPrefix=</span><span class="s">&quot;/private/&quot;</span>
<span class="w">        </span><span class="na">android:permission=</span><span class="s">&quot;com.example.ACCESS_PRIVATE&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/provider&gt;</span>
</code></pre></div>

<ol start="2">
<li><strong>åŠ¨æ€æƒé™æˆäºˆ</strong>ï¼š</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1">// æˆäºˆä¸´æ—¶è¯»æƒé™</span>
<span class="n">grantUriPermission</span><span class="p">(</span><span class="n">targetPackage</span><span class="p">,</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="n">Intent</span><span class="p">.</span><span class="na">FLAG_GRANT_READ_URI_PERMISSION</span><span class="p">);</span>

<span class="c1">// é€šè¿‡Intentä¼ é€’æƒé™</span>
<span class="n">Intent</span><span class="w"> </span><span class="n">intent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Intent</span><span class="p">();</span>
<span class="n">intent</span><span class="p">.</span><span class="na">setData</span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<span class="n">intent</span><span class="p">.</span><span class="na">addFlags</span><span class="p">(</span><span class="n">Intent</span><span class="p">.</span><span class="na">FLAG_GRANT_READ_URI_PERMISSION</span><span class="p">);</span>
</code></pre></div>

<h3 id="933-uri-permissions">9.3.3 ä¸´æ—¶æƒé™(URI permissions)</h3>
<p>ä¸´æ—¶æƒé™æœºåˆ¶çš„å®ç°åŸç†ï¼š</p>
<div class="codehilite"><pre><span></span><code>ä¸´æ—¶æƒé™ç®¡ç†æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   App A     â”‚     â”‚ActivityManager   â”‚     â”‚   App B     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                      â”‚
       â”‚ grantUriPermission()â”‚                      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                      â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ è®°å½•æƒé™æˆäºˆ         â”‚
       â”‚                     â”‚ (UriPermissionå¯¹è±¡)  â”‚
       â”‚                     â”‚                      â”‚
       â”‚ è¿”å›æˆåŠŸ            â”‚                      â”‚
       â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚     è®¿é—®URI          â”‚
       â”‚                     â”‚&lt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ æ£€æŸ¥UriPermission   â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ å…è®¸è®¿é—®            â”‚
       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
</code></pre></div>

<p>UriPermissionçš„å…³é”®å±æ€§ï¼š</p>
<ul>
<li><strong>ç›®æ ‡åŒ…å</strong>ï¼šè¢«æˆæƒçš„åº”ç”¨</li>
<li><strong>URIæ¨¡å¼</strong>ï¼šå¯ä»¥æ˜¯ç²¾ç¡®URIæˆ–URIå‰ç¼€</li>
<li><strong>æƒé™æ ‡å¿—</strong>ï¼šè¯»/å†™æƒé™</li>
<li><strong>æŒä¹…åŒ–æ ‡å¿—</strong>ï¼šæ˜¯å¦åœ¨é‡å¯åä¿ç•™</li>
</ul>
<h3 id="934">9.3.4 è·¯å¾„çº§æƒé™æ§åˆ¶</h3>
<p>Androidæ”¯æŒç»†ç²’åº¦çš„è·¯å¾„çº§æƒé™ï¼š</p>
<div class="codehilite"><pre><span></span><code>æƒé™å±‚çº§ç»“æ„ï¼š
Providerçº§åˆ«æƒé™
    â”‚
    â”œâ”€â”€ å…¨å±€è¯»æƒé™ (android:readPermission)
    â”œâ”€â”€ å…¨å±€å†™æƒé™ (android:writePermission)
    â”‚
    â””â”€â”€ è·¯å¾„çº§æƒé™ (path-permission)
        â”œâ”€â”€ /public/* â†’ æ— éœ€æƒé™
        â”œâ”€â”€ /private/* â†’ éœ€è¦PRIVATEæƒé™
        â””â”€â”€ /admin/* â†’ éœ€è¦ADMINæƒé™
</code></pre></div>

<p>æƒé™æ£€æŸ¥æµç¨‹ï¼š</p>
<ol>
<li><strong>æ£€æŸ¥ä¸´æ—¶URIæƒé™</strong>ï¼šä¼˜å…ˆçº§æœ€é«˜</li>
<li><strong>æ£€æŸ¥è·¯å¾„çº§æƒé™</strong>ï¼šåŒ¹é…æœ€å…·ä½“çš„è·¯å¾„</li>
<li><strong>æ£€æŸ¥å…¨å±€æƒé™</strong>ï¼šä½œä¸ºé»˜è®¤æƒé™</li>
<li><strong>æ£€æŸ¥exportedå±æ€§</strong>ï¼šæ˜¯å¦å…è®¸å¤–éƒ¨è®¿é—®</li>
</ol>
<h2 id="94">9.4 æ•°æ®å˜æ›´é€šçŸ¥æœºåˆ¶</h2>
<h3 id="941-contentobserver">9.4.1 ContentObserverå®ç°åŸç†</h3>
<p>ContentObserveræä¾›äº†é«˜æ•ˆçš„æ•°æ®å˜æ›´é€šçŸ¥æœºåˆ¶ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// æ³¨å†Œè§‚å¯Ÿè€…</span>
<span class="n">getContentResolver</span><span class="p">().</span><span class="na">registerContentObserver</span><span class="p">(</span>
<span class="w">    </span><span class="n">uri</span><span class="p">,</span>
<span class="w">    </span><span class="kc">true</span><span class="p">,</span><span class="w">  </span><span class="c1">// notifyForDescendants</span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">ContentObserver</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nd">@Override</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onChange</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">selfChange</span><span class="p">,</span><span class="w"> </span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// å¤„ç†æ•°æ®å˜æ›´</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">);</span>
</code></pre></div>

<p>åº•å±‚å®ç°æ¶æ„ï¼š</p>
<div class="codehilite"><pre><span></span><code>é€šçŸ¥æœºåˆ¶æ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Providerè¿›ç¨‹  â”‚     â”‚  System Server   â”‚     â”‚Observerè¿›ç¨‹ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚                      â”‚
       â”‚ notifyChange(uri)   â”‚                      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚                      â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ æŸ¥æ‰¾æ³¨å†Œçš„Observer   â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚ é€šè¿‡Binderå›è°ƒ       â”‚
       â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&gt;â”‚
       â”‚                     â”‚                      â”‚
       â”‚                     â”‚                      â”‚onChange()
</code></pre></div>

<p>å…³é”®ç»„ä»¶ï¼š</p>
<ul>
<li><strong>ContentService</strong>ï¼šç³»ç»ŸæœåŠ¡ï¼Œç®¡ç†æ‰€æœ‰Observeræ³¨å†Œ</li>
<li><strong>ObserverNodeæ ‘</strong>ï¼šé«˜æ•ˆçš„URIåŒ¹é…æ ‘ç»“æ„</li>
<li><strong>IContentObserver</strong>ï¼šè·¨è¿›ç¨‹å›è°ƒæ¥å£</li>
</ul>
<h3 id="942">9.4.2 è·¨è¿›ç¨‹é€šçŸ¥æœºåˆ¶</h3>
<p>è·¨è¿›ç¨‹é€šçŸ¥çš„ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<ol>
<li><strong>æ‰¹é‡é€šçŸ¥åˆå¹¶</strong>ï¼š</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1">// ContentServiceä¸­çš„é€šçŸ¥å»¶è¿Ÿæœºåˆ¶</span>
<span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">collectMyObserversLocked</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flags</span><span class="p">,</span>
<span class="w">        </span><span class="n">IContentObserver</span><span class="w"> </span><span class="n">observer</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">selfChange</span><span class="p">,</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">ObserverCall</span><span class="o">&gt;</span><span class="w"> </span><span class="n">calls</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// æ”¶é›†æ‰€æœ‰éœ€è¦é€šçŸ¥çš„Observer</span>
<span class="w">    </span><span class="c1">// é¿å…é‡å¤é€šçŸ¥</span>
<span class="p">}</span>
</code></pre></div>

<ol start="2">
<li>
<p><strong>å¼‚æ­¥é€šçŸ¥åˆ†å‘</strong>ï¼š
- ä½¿ç”¨Handlerå°†é€šçŸ¥poståˆ°ç›®æ ‡çº¿ç¨‹
- é¿å…é˜»å¡Providerè¿›ç¨‹</p>
</li>
<li>
<p><strong>é€šçŸ¥è¿‡æ»¤</strong>ï¼š
- åŸºäºURIçš„å±‚çº§åŒ¹é…
- notifyForDescendantsæ§åˆ¶æ˜¯å¦é€šçŸ¥å­URI</p>
</li>
</ol>
<h3 id="943-livedata">9.4.3 ä¸LiveDataé›†æˆ</h3>
<p>ç°ä»£Androidå¼€å‘ä¸­ï¼ŒContentProviderä¸LiveDataçš„é›†æˆï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// ContentProvider LiveDataåŒ…è£…</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ContentProviderLiveData</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">LiveData</span><span class="o">&lt;</span><span class="n">Cursor</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ContentResolver</span><span class="w"> </span><span class="n">contentResolver</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ContentObserver</span><span class="w"> </span><span class="n">observer</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onActive</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">observer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ContentObserver</span><span class="p">(</span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onChange</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">selfChange</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// é‡æ–°æŸ¥è¯¢å¹¶æ›´æ–°LiveData</span>
<span class="w">                </span><span class="n">loadData</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">        </span><span class="n">contentResolver</span><span class="p">.</span><span class="na">registerContentObserver</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">observer</span><span class="p">);</span>
<span class="w">        </span><span class="n">loadData</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onInactive</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">contentResolver</span><span class="p">.</span><span class="na">unregisterContentObserver</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="95-ios">9.5 ä¸iOSæ•°æ®å…±äº«æœºåˆ¶å¯¹æ¯”</h2>
<h3 id="951-ios-app-groups">9.5.1 iOS App Groups</h3>
<p>iOSä½¿ç”¨App Groupså®ç°åº”ç”¨é—´æ•°æ®å…±äº«ï¼š</p>
<div class="codehilite"><pre><span></span><code>iOS App Groupsæ¶æ„ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          App Group Container         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  App A  â”‚  â”‚  App B  â”‚  â”‚App C â”‚â”‚
â”‚  â”‚         â”‚  â”‚         â”‚  â”‚      â”‚â”‚
â”‚  â”‚ å…±äº«å­˜å‚¨ â”‚  â”‚ å…±äº«å­˜å‚¨ â”‚  â”‚å…±äº«  â”‚â”‚
â”‚  â”‚UserDefaultsâ”‚UserDefaultsâ”‚å­˜å‚¨  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                      â”‚
â”‚        Shared Container Path         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<p>å…³é”®å·®å¼‚ï¼š</p>
<ul>
<li><strong>æƒé™æ¨¡å‹</strong>ï¼šApp GroupsåŸºäºå¼€å‘è€…è´¦å·å’Œentitlements</li>
<li><strong>æ•°æ®è®¿é—®</strong>ï¼šç›´æ¥æ–‡ä»¶ç³»ç»Ÿè®¿é—®ï¼Œæ— éœ€IPC</li>
<li><strong>çµæ´»æ€§</strong>ï¼šä»…é™åŒä¸€å¼€å‘è€…çš„åº”ç”¨</li>
</ul>
<h3 id="952-ios-document-provider">9.5.2 iOS Document Provider</h3>
<p>iOSçš„Document Provider Extensionæä¾›äº†æ›´æ¥è¿‘ContentProviderçš„åŠŸèƒ½ï¼š</p>
<div class="codehilite"><pre><span></span><code>å¯¹æ¯”è¡¨æ ¼ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ç‰¹æ€§        â”‚  Android ContentProviderâ”‚ iOS Document Providerâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è·¨åº”ç”¨å…±äº«      â”‚        âœ“             â”‚         âœ“            â”‚
â”‚ ç»“æ„åŒ–æ•°æ®      â”‚        âœ“             â”‚         âœ—            â”‚
â”‚ å®æ—¶é€šçŸ¥        â”‚        âœ“             â”‚         âœ—            â”‚
â”‚ æƒé™ç²’åº¦        â”‚      URIçº§åˆ«          â”‚       æ–‡ä»¶çº§åˆ«        â”‚
â”‚ è¿›ç¨‹æ¨¡å‹        â”‚      ç‹¬ç«‹è¿›ç¨‹         â”‚     Extensionè¿›ç¨‹     â”‚
â”‚ æŸ¥è¯¢èƒ½åŠ›        â”‚      SQL-like         â”‚       æœ‰é™           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>

<h3 id="953">9.5.3 æ€§èƒ½å¯¹æ¯”åˆ†æ</h3>
<p>æ€§èƒ½ç‰¹å¾å¯¹æ¯”ï¼š</p>
<ol>
<li>
<p><strong>Android ContentProvider</strong>ï¼š
   - ä¼˜åŠ¿ï¼šæ‰¹é‡æ“ä½œä¼˜åŒ–ã€å…±äº«å†…å­˜ä¼ è¾“
   - åŠ£åŠ¿ï¼šBinderè°ƒç”¨å¼€é”€ã€è¿›ç¨‹å¯åŠ¨å»¶è¿Ÿ</p>
</li>
<li>
<p><strong>iOS App Groups</strong>ï¼š
   - ä¼˜åŠ¿ï¼šç›´æ¥æ–‡ä»¶è®¿é—®ã€æ— IPCå¼€é”€
   - åŠ£åŠ¿ï¼šç¼ºä¹å¹¶å‘æ§åˆ¶ã€æ— äº‹åŠ¡æ”¯æŒ</p>
</li>
<li>
<p><strong>iOS Document Provider</strong>ï¼š
   - ä¼˜åŠ¿ï¼šç³»ç»Ÿçº§UIé›†æˆ
   - åŠ£åŠ¿ï¼šä»…é™æ–‡æ¡£å‹æ•°æ®ã€æ€§èƒ½å¼€é”€è¾ƒå¤§</p>
</li>
</ol>
<h2 id="96">9.6 é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–</h2>
<h3 id="961">9.6.1 æµå¼æ•°æ®ä¼ è¾“</h3>
<p>ContentProvideræ”¯æŒå¤§æ–‡ä»¶å’Œæµå¼æ•°æ®ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// æ‰“å¼€æ–‡ä»¶æµ</span>
<span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">ParcelFileDescriptor</span><span class="w"> </span><span class="nf">openFile</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">FileNotFoundException</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">File</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFileForUri</span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">fileMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ParcelFileDescriptor</span><span class="p">.</span><span class="na">parseMode</span><span class="p">(</span><span class="n">mode</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ParcelFileDescriptor</span><span class="p">.</span><span class="na">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">fileMode</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// ç®¡é“ä¼ è¾“ï¼ˆé€‚ç”¨äºåŠ¨æ€ç”Ÿæˆçš„æ•°æ®ï¼‰</span>
<span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">ParcelFileDescriptor</span><span class="w"> </span><span class="nf">openPipeHelper</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">mimeType</span><span class="p">,</span>
<span class="w">        </span><span class="n">Bundle</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">PipeDataWriter</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">writer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">openPipeHelper</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">mimeType</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">writer</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="962">9.6.2 å†…å­˜æ˜ å°„ä¼˜åŒ–</h3>
<p>å¯¹äºå¤§æ•°æ®é›†çš„ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<ol>
<li>
<p><strong>CursorWindowåˆ†é¡µ</strong>ï¼š
   - åŠ¨æ€è°ƒæ•´çª—å£å¤§å°
   - é¢„å–ç­–ç•¥ä¼˜åŒ–</p>
</li>
<li>
<p><strong>å»¶è¿ŸåŠ è½½</strong>ï¼š
   - ä»…åœ¨éœ€è¦æ—¶åŠ è½½æ•°æ®åˆ—
   - ä½¿ç”¨æŠ•å½±(projection)å‡å°‘æ•°æ®ä¼ è¾“</p>
</li>
<li>
<p><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼š
   - Providerç«¯ç»“æœç¼“å­˜
   - å®¢æˆ·ç«¯Cursorç¼“å­˜</p>
</li>
</ol>
<h3 id="963">9.6.3 æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–</h3>
<p>æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// 1. ä½¿ç”¨ç´¢å¼•æç¤º</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Cursor</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">projection</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">String</span><span class="w"> </span><span class="n">selection</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">selectionArgs</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">String</span><span class="w"> </span><span class="n">sortOrder</span><span class="p">,</span><span class="w"> </span><span class="n">CancellationSignal</span><span class="w"> </span><span class="n">cancellationSignal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// 2. æŸ¥è¯¢å–æ¶ˆæ”¯æŒ</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cancellationSignal</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cancellationSignal</span><span class="p">.</span><span class="na">throwIfCanceled</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 3. é™åˆ¶ç»“æœé›†å¤§å°</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uri</span><span class="p">.</span><span class="na">getQueryParameter</span><span class="p">(</span><span class="s">&quot;limit&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. ä½¿ç”¨æŸ¥è¯¢ä¼˜åŒ–å™¨æç¤º</span>
<span class="w">    </span><span class="n">Bundle</span><span class="w"> </span><span class="n">queryArgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Bundle</span><span class="p">();</span>
<span class="w">    </span><span class="n">queryArgs</span><span class="p">.</span><span class="na">putString</span><span class="p">(</span><span class="n">ContentResolver</span><span class="p">.</span><span class="na">QUERY_ARG_SQL_SELECTION</span><span class="p">,</span><span class="w"> </span><span class="n">selection</span><span class="p">);</span>
<span class="w">    </span><span class="n">queryArgs</span><span class="p">.</span><span class="na">putStringArray</span><span class="p">(</span><span class="n">ContentResolver</span><span class="p">.</span><span class="na">QUERY_ARG_SQL_SELECTION_ARGS</span><span class="p">,</span><span class="w"> </span><span class="n">selectionArgs</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">query</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">projection</span><span class="p">,</span><span class="w"> </span><span class="n">queryArgs</span><span class="p">,</span><span class="w"> </span><span class="n">cancellationSignal</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="97">9.7 å®‰å…¨è€ƒè™‘</h2>
<h3 id="971-sql">9.7.1 SQLæ³¨å…¥é˜²æŠ¤</h3>
<p>ContentProviderå¿…é¡»é˜²èŒƒSQLæ³¨å…¥æ”»å‡»ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// é”™è¯¯ç¤ºä¾‹ - å­˜åœ¨SQLæ³¨å…¥é£é™©</span>
<span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SELECT * FROM table WHERE name = &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">userInput</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">;</span>

<span class="c1">// æ­£ç¡®ç¤ºä¾‹ - ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢</span>
<span class="n">String</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name = ?&quot;</span><span class="p">;</span>
<span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">selectionArgs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">userInput</span><span class="p">};</span>
</code></pre></div>

<p>é˜²æŠ¤æªæ–½ï¼š</p>
<ol>
<li><strong>å§‹ç»ˆä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢</strong></li>
<li><strong>éªŒè¯URIå‚æ•°</strong></li>
<li><strong>é™åˆ¶æŸ¥è¯¢å¤æ‚åº¦</strong></li>
<li><strong>ä½¿ç”¨SQLiteQueryBuilder</strong></li>
</ol>
<h3 id="972">9.7.2 æƒé™æå‡é£é™©</h3>
<p>é¿å…æƒé™æ³„éœ²çš„å…³é”®ç‚¹ï¼š</p>
<ol>
<li><strong>è·¯å¾„éå†é˜²æŠ¤</strong>ï¼š</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1">// éªŒè¯è¯·æ±‚çš„URIè·¯å¾„</span>
<span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">validateUri</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pathSegments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uri</span><span class="p">.</span><span class="na">getPathSegments</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">pathSegments</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">segment</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;..&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecurityException</span><span class="p">(</span><span class="s">&quot;Path traversal attempt&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<ol start="2">
<li><strong>æƒé™ä¼ é€’æ£€æŸ¥</strong>ï¼š
- éªŒè¯è°ƒç”¨è€…èº«ä»½
- é™åˆ¶æƒé™ä¼ é€’èŒƒå›´
- è®°å½•æƒé™æˆäºˆæ—¥å¿—</li>
</ol>
<h3 id="973">9.7.3 æ•°æ®æ³„éœ²é˜²èŒƒ</h3>
<p>æ•°æ®ä¿æŠ¤æœ€ä½³å®è·µï¼š</p>
<ol>
<li>
<p><strong>æ•æ„Ÿæ•°æ®åŠ å¯†</strong>ï¼š
   - æ•°æ®åº“çº§åŠ å¯†ï¼ˆSQLCipherï¼‰
   - å­—æ®µçº§åŠ å¯†</p>
</li>
<li>
<p><strong>è®¿é—®å®¡è®¡</strong>ï¼š
   - è®°å½•æ‰€æœ‰æ•°æ®è®¿é—®
   - å¼‚å¸¸è®¿é—®æ£€æµ‹</p>
</li>
<li>
<p><strong>æ•°æ®æœ€å°åŒ–</strong>ï¼š
   - ä»…è¿”å›å¿…è¦å­—æ®µ
   - å®æ–½æ•°æ®è„±æ•</p>
</li>
</ol>
<h2 id="_2">æœ¬ç« å°ç»“</h2>
<p>ContentProviderä½œä¸ºAndroidå››å¤§ç»„ä»¶ä¹‹ä¸€ï¼Œæä¾›äº†å¼ºå¤§è€Œçµæ´»çš„è·¨è¿›ç¨‹æ•°æ®å…±äº«æœºåˆ¶ã€‚å…¶æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ ‡å‡†åŒ–çš„æ•°æ®è®¿é—®æ¥å£</strong>ï¼šé€šè¿‡ç»Ÿä¸€çš„CRUDæ“ä½œå’ŒURIä½“ç³»ï¼Œç®€åŒ–äº†è·¨åº”ç”¨æ•°æ®è®¿é—®</li>
<li><strong>ç»†ç²’åº¦çš„æƒé™æ§åˆ¶</strong>ï¼šä»Providerçº§åˆ«åˆ°URIè·¯å¾„çº§åˆ«çš„å¤šå±‚æƒé™ä½“ç³»ï¼Œç¡®ä¿æ•°æ®å®‰å…¨</li>
<li><strong>é«˜æ•ˆçš„IPCæœºåˆ¶</strong>ï¼šåŸºäºBinderçš„è·¨è¿›ç¨‹é€šä¿¡ï¼Œé…åˆCursorWindowå…±äº«å†…å­˜ä¼˜åŒ–å¤§æ•°æ®ä¼ è¾“</li>
<li><strong>å®æ—¶æ•°æ®åŒæ­¥</strong>ï¼šContentObserveræœºåˆ¶æ”¯æŒæ•°æ®å˜æ›´çš„å®æ—¶é€šçŸ¥</li>
<li><strong>ä¸ç°ä»£æ¶æ„çš„é›†æˆ</strong>ï¼šå¯ä»¥ä¸LiveDataã€Roomç­‰ç°ä»£Androidæ¶æ„ç»„ä»¶æ— ç¼é›†æˆ</li>
</ol>
<p>ä¸iOSç›¸æ¯”ï¼ŒAndroidçš„ContentProvideræä¾›äº†æ›´å¼ºå¤§çš„ç»“æ„åŒ–æ•°æ®å…±äº«èƒ½åŠ›ï¼Œä½†ä¹Ÿå¸¦æ¥äº†æ›´é«˜çš„å¤æ‚åº¦ã€‚åœ¨è®¾è®¡æ•°æ®å…±äº«æ–¹æ¡ˆæ—¶ï¼Œéœ€è¦æƒè¡¡åŠŸèƒ½éœ€æ±‚ã€æ€§èƒ½è¦æ±‚å’Œå®‰å…¨è€ƒè™‘ã€‚</p>
<p>å…³é”®å®ç°è¦ç‚¹ï¼š</p>
<ul>
<li>ContentProviderçš„ç”Ÿå‘½å‘¨æœŸç”±ç³»ç»Ÿç®¡ç†ï¼Œéœ€è¦è€ƒè™‘è¿›ç¨‹å¯åŠ¨çš„æ€§èƒ½å½±å“</li>
<li>URIæƒé™æ¨¡å‹æä¾›äº†çµæ´»çš„è®¿é—®æ§åˆ¶ï¼Œä½†éœ€è¦è°¨æ…è®¾è®¡é¿å…æƒé™æ³„éœ²</li>
<li>æ‰¹é‡æ“ä½œå’Œäº‹åŠ¡æ”¯æŒå¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½</li>
<li>å®‰å…¨æ€§æ˜¯è®¾è®¡çš„é¦–è¦è€ƒè™‘ï¼Œå¿…é¡»é˜²èŒƒSQLæ³¨å…¥ã€æƒé™æå‡ç­‰æ”»å‡»</li>
</ul>
<h2 id="_3">ç»ƒä¹ é¢˜</h2>
<h3 id="_4">åŸºç¡€é¢˜</h3>
<ol>
<li><strong>ContentProviderç”Ÿå‘½å‘¨æœŸ</strong></li>
</ol>
<p>æè¿°ContentProviderçš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶è§£é‡Šä¸ºä»€ä¹ˆContentProvideræ²¡æœ‰onDestroy()æ–¹æ³•ï¼Ÿ</p>
<p><em>Hint: è€ƒè™‘ContentProviderä¸è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸçš„å…³ç³»</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   ContentProviderçš„ç”Ÿå‘½å‘¨æœŸä¸å…¶æ‰€åœ¨è¿›ç¨‹ç»‘å®šã€‚ä¸»è¦é˜¶æ®µåŒ…æ‹¬ï¼š

   - onCreate()ï¼šåœ¨Providerè¿›ç¨‹å¯åŠ¨æ—¶è°ƒç”¨ï¼Œæ—©äºApplication.onCreate()
   - æ´»è·ƒé˜¶æ®µï¼šå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚
   - éšè¿›ç¨‹é”€æ¯ï¼šå½“è¿›ç¨‹è¢«ç³»ç»Ÿå›æ”¶æ—¶è‡ªåŠ¨é”€æ¯

   æ²¡æœ‰onDestroy()çš„åŸå› ï¼š

   - ContentProviderçš„é”€æ¯æ€»æ˜¯ä¼´éšè¿›ç¨‹é”€æ¯
   - è¿›ç¨‹é”€æ¯æ—¶æ— æ³•ä¿è¯å›è°ƒæ‰§è¡Œ
   - èµ„æºæ¸…ç†åº”åœ¨æ¯æ¬¡æ“ä½œå®Œæˆåè¿›è¡Œï¼Œè€Œéä¾èµ–é”€æ¯å›è°ƒ
   </details>
<ol start="2">
<li><strong>URIæƒé™æ£€æŸ¥é¡ºåº</strong></li>
</ol>
<p>ç»™å®šä»¥ä¸‹Provideré…ç½®ï¼Œåˆ†æè®¿é—®<code>content://com.example.provider/private/data</code>æ—¶çš„æƒé™æ£€æŸ¥é¡ºåºï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;provider</span>
<span class="w">    </span><span class="na">android:authorities=</span><span class="s">&quot;com.example.provider&quot;</span>
<span class="w">    </span><span class="na">android:readPermission=</span><span class="s">&quot;READ_PROVIDER&quot;</span>
<span class="w">    </span><span class="na">android:exported=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;path-permission</span>
<span class="w">        </span><span class="na">android:pathPrefix=</span><span class="s">&quot;/private/&quot;</span>
<span class="w">        </span><span class="na">android:permission=</span><span class="s">&quot;ACCESS_PRIVATE&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/provider&gt;</span>
</code></pre></div>

<p><em>Hint: è€ƒè™‘ä¸´æ—¶æƒé™çš„ä¼˜å…ˆçº§</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   æƒé™æ£€æŸ¥é¡ºåºï¼š

   1. æ£€æŸ¥æ˜¯å¦æœ‰ä¸´æ—¶URIæƒé™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
   2. æ£€æŸ¥è·¯å¾„æƒé™ï¼šéœ€è¦ACCESS_PRIVATEæƒé™
   3. å¦‚æœæ²¡æœ‰è·¯å¾„æƒé™ï¼Œå›é€€åˆ°å…¨å±€æƒé™ï¼šéœ€è¦READ_PROVIDER
   4. æœ€ç»ˆæ£€æŸ¥exportedå±æ€§ï¼ˆè¿™é‡Œä¸ºtrueï¼Œå…è®¸å¤–éƒ¨è®¿é—®ï¼‰

   æ³¨æ„ï¼šè·¯å¾„æƒé™æ¯”å…¨å±€æƒé™ä¼˜å…ˆçº§æ›´é«˜ï¼Œæ›´å…·ä½“çš„è·¯å¾„åŒ¹é…ä¼˜å…ˆ
   </details>
<ol start="3">
<li><strong>CursorWindowæœºåˆ¶</strong></li>
</ol>
<p>è§£é‡ŠCursorWindowçš„ä½œç”¨ï¼Œä»¥åŠä¸ºä»€ä¹ˆé»˜è®¤å¤§å°æ˜¯2MBï¼Ÿ</p>
<p><em>Hint: è€ƒè™‘Androidçš„Binderé™åˆ¶</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   CursorWindowæ˜¯ç”¨äºè·¨è¿›ç¨‹ä¼ è¾“æŸ¥è¯¢ç»“æœçš„å…±äº«å†…å­˜çª—å£ï¼š

   ä½œç”¨ï¼š

   - é¿å…é€šè¿‡Binderä¼ è¾“å¤§é‡æ•°æ®
   - ä½¿ç”¨ashmem(åŒ¿åå…±äº«å†…å­˜)å®ç°é›¶æ‹·è´ä¼ è¾“
   - æ”¯æŒåˆ†é¡µåŠ è½½å¤§ç»“æœé›†

   2MBå¤§å°çš„åŸå› ï¼š

   - Binderäº‹åŠ¡ç¼“å†²åŒºé™åˆ¶ä¸º1MB
   - 2MBå¯ä»¥å®¹çº³åˆç†å¤§å°çš„ç»“æœé›†
   - è¿‡å¤§ä¼šå ç”¨è¿‡å¤šå†…å­˜ï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½
   - å¯é€šè¿‡ç³»ç»Ÿå±æ€§è°ƒæ•´ï¼Œä½†éœ€è°¨æ…
   </details>
<ol start="4">
<li><strong>ContentObserveré€šçŸ¥æœºåˆ¶</strong></li>
</ol>
<p>ç¼–å†™ä¼ªä»£ç è¯´æ˜å¦‚ä½•å®ç°ä¸€ä¸ªæ”¯æŒæ‰¹é‡æ›´æ–°ä¸”åªå‘é€ä¸€æ¬¡é€šçŸ¥çš„ContentProvideræ–¹æ³•ã€‚</p>
<p><em>Hint: ä½¿ç”¨äº‹åŠ¡å’Œé€šçŸ¥å»¶è¿Ÿ</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   ```java
   public int bulkUpdate(Uri uri, ContentValues[] values, 
                        String[] selections, String[][] selectionArgs) {
       int count = 0;
       boolean notifyChange = false;

       db.beginTransaction();
       try {
           // ä¸´æ—¶ç¦ç”¨è‡ªåŠ¨é€šçŸ¥
           for (int i = 0; i &lt; values.length; i++) {
               count += updateInternal(uri, values[i], 
                                     selections[i], selectionArgs[i], 
                                     false); // ä¸å‘é€é€šçŸ¥
           }
           db.setTransactionSuccessful();
           notifyChange = true;
       } finally {
           db.endTransaction();
       }

       // äº‹åŠ¡å®Œæˆåå‘é€ä¸€æ¬¡é€šçŸ¥
       if (notifyChange &amp;&amp; count &gt; 0) {
           getContext().getContentResolver().notifyChange(uri, null);
       }

       return count;
   }
   ```
   </details>
<h3 id="_5">æŒ‘æˆ˜é¢˜</h3>
<ol start="5">
<li><strong>è·¨è¿›ç¨‹Cursorä¼˜åŒ–</strong></li>
</ol>
<p>è®¾è®¡ä¸€ä¸ªæ–¹æ¡ˆï¼Œä¼˜åŒ–ContentProviderè¿”å›100ä¸‡æ¡è®°å½•æ—¶çš„æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨ã€‚è€ƒè™‘ä»¥ä¸‹çº¦æŸï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯å¯èƒ½åªéœ€è¦æŸ¥çœ‹å‰å‡ ç™¾æ¡</li>
<li>éœ€è¦æ”¯æŒéšæœºè®¿é—®</li>
<li>æœ€å°åŒ–å†…å­˜å ç”¨</li>
</ul>
<p><em>Hint: è€ƒè™‘æ‡’åŠ è½½ã€åˆ†é¡µå’Œç¼“å­˜ç­–ç•¥</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡ï¼š

   1. **Providerç«¯ä¼˜åŒ–**ï¼š
      - å®ç°è‡ªå®šä¹‰Cursorï¼Œæ”¯æŒåˆ†é¡µåŠ è½½
      - ä½¿ç”¨SQLiteçš„LIMIT/OFFSETè¿›è¡Œæ•°æ®åº“çº§åˆ†é¡µ
      - ç¼“å­˜æœ€è¿‘è®¿é—®çš„é¡µé¢

   2. **ä¼ è¾“ä¼˜åŒ–**ï¼š
      - åˆå§‹åªä¼ è¾“ç¬¬ä¸€ä¸ªCursorWindowï¼ˆçº¦2000è¡Œï¼‰
      - å®ç°æŒ‰éœ€åŠ è½½çš„è¿œç¨‹Cursoræ¥å£
      - ä½¿ç”¨å¼±å¼•ç”¨ç¼“å­˜å·²åŠ è½½çš„çª—å£

   3. **å®¢æˆ·ç«¯ä¼˜åŒ–**ï¼š
      - å®ç°é¢„å–æœºåˆ¶ï¼Œé¢„æµ‹ç”¨æˆ·æ»šåŠ¨æ–¹å‘
      - è®¾ç½®åˆç†çš„ç¼“å­˜çª—å£å¤§å°
      - åŠæ—¶é‡Šæ”¾ä¸å†å¯è§çš„æ•°æ®

   4. **å…³é”®å®ç°ç‚¹**ï¼š


<div class="codehilite"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PagedCursor</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AbstractCursor</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">PAGE_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LruCache</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span><span class="w"> </span><span class="n">CursorWindow</span><span class="o">&gt;</span><span class="w"> </span><span class="n">windowCache</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Uri</span><span class="w"> </span><span class="n">queryUri</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">CursorWindow</span><span class="w"> </span><span class="nf">getWindow</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">startPos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPosition</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">PAGE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">PAGE_SIZE</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getOrCreateWindow</span><span class="p">(</span><span class="n">startPos</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


   </details>
<ol start="6">
<li><strong>å®‰å…¨çš„Providerè®¾è®¡</strong></li>
</ol>
<p>è®¾è®¡ä¸€ä¸ªContentProviderï¼Œè¦æ±‚ï¼š</p>
<ul>
<li>æ”¯æŒå¤šç§Ÿæˆ·æ•°æ®éš”ç¦»</li>
<li>é˜²æ­¢æ¨ªå‘è¶Šæƒè®¿é—®</li>
<li>æ”¯æŒç»†ç²’åº¦çš„å­—æ®µçº§æƒé™</li>
<li>å®¡è®¡æ‰€æœ‰æ•°æ®è®¿é—®</li>
</ul>
<p><em>Hint: è€ƒè™‘URIè®¾è®¡ã€æƒé™æ¨¡å‹å’Œå®¡è®¡æœºåˆ¶</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   å®‰å…¨Providerè®¾è®¡æ–¹æ¡ˆï¼š

   1. **URIè®¾è®¡**ï¼š


<div class="codehilite"><pre><span></span><code>content://authority/tenant/{tenantId}/resource/{resourceId}
content://authority/user/{userId}/profile?fields=name,email
</code></pre></div>



   2. **æƒé™éªŒè¯å±‚æ¬¡**ï¼š
      - ç§Ÿæˆ·çº§åˆ«ï¼šéªŒè¯è°ƒç”¨è€…å±äºæŒ‡å®šç§Ÿæˆ·
      - èµ„æºçº§åˆ«ï¼šæ£€æŸ¥èµ„æºæ‰€æœ‰æƒæˆ–è®¿é—®æƒé™
      - å­—æ®µçº§åˆ«ï¼šæ ¹æ®æƒé™è¿‡æ»¤è¿”å›å­—æ®µ

   3. **å®ç°è¦ç‚¹**ï¼š


<div class="codehilite"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Cursor</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">projection</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. æå–å¹¶éªŒè¯ç§Ÿæˆ·ID</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">tenantId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uri</span><span class="p">.</span><span class="na">getPathSegments</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">validateTenantAccess</span><span class="p">(</span><span class="n">getCallingUid</span><span class="p">(),</span><span class="w"> </span><span class="n">tenantId</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. å­—æ®µçº§æƒé™è¿‡æ»¤</span>
<span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">allowedProjection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filterProjection</span><span class="p">(</span>
<span class="w">        </span><span class="n">projection</span><span class="p">,</span><span class="w"> </span><span class="n">getCallerPermissions</span><span class="p">());</span>

<span class="w">    </span><span class="c1">// 3. æ·»åŠ ç§Ÿæˆ·è¿‡æ»¤æ¡ä»¶</span>
<span class="w">    </span><span class="n">selection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addTenantFilter</span><span class="p">(</span><span class="n">selection</span><span class="p">,</span><span class="w"> </span><span class="n">tenantId</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 4. å®¡è®¡æ—¥å¿—</span>
<span class="w">    </span><span class="n">auditAccess</span><span class="p">(</span><span class="n">getCallingUid</span><span class="p">(),</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">allowedProjection</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 5. æ‰§è¡ŒæŸ¥è¯¢</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kd">super</span><span class="p">.</span><span class="na">query</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">allowedProjection</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
<span class="p">}</span>
</code></pre></div>



   4. **å®¡è®¡æœºåˆ¶**ï¼š
      - å¼‚æ­¥å†™å…¥å®¡è®¡æ—¥å¿—
      - è®°å½•ï¼šæ—¶é—´æˆ³ã€è°ƒç”¨è€…UIDã€è®¿é—®çš„URIã€å­—æ®µ
      - å¼‚å¸¸æ£€æµ‹ï¼šé¢‘ç‡é™åˆ¶ã€å¼‚å¸¸è®¿é—®æ¨¡å¼å‘Šè­¦
   </details>
<ol start="7">
<li><strong>é«˜æ€§èƒ½æ–‡ä»¶å…±äº«</strong></li>
</ol>
<p>è®¾è®¡ä¸€ä¸ªåŸºäºContentProviderçš„é«˜æ€§èƒ½æ–‡ä»¶å…±äº«ç³»ç»Ÿï¼Œè¦æ±‚ï¼š</p>
<ul>
<li>æ”¯æŒå¤§æ–‡ä»¶ï¼ˆ&gt;1GBï¼‰çš„é«˜æ•ˆä¼ è¾“</li>
<li>æ”¯æŒæ–­ç‚¹ç»­ä¼ </li>
<li>æœ€å°åŒ–å†…å­˜å ç”¨</li>
<li>æ”¯æŒå¹¶å‘è®¿é—®</li>
</ul>
<p><em>Hint: è€ƒè™‘ParcelFileDescriptorã€ç®¡é“å’Œå†…å­˜æ˜ å°„</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   é«˜æ€§èƒ½æ–‡ä»¶å…±äº«è®¾è®¡ï¼š

   1. **åŸºç¡€æ¶æ„**ï¼š


<div class="codehilite"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">ParcelFileDescriptor</span><span class="w"> </span><span class="nf">openFile</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">mode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// æ”¯æŒéƒ¨åˆ†å†…å®¹è¯·æ±‚</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">rangeHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uri</span><span class="p">.</span><span class="na">getQueryParameter</span><span class="p">(</span><span class="s">&quot;range&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rangeHeader</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">openFileWithRange</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="p">,</span><span class="w"> </span><span class="n">rangeHeader</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// å¤§æ–‡ä»¶ä½¿ç”¨å†…å­˜æ˜ å°„</span>
<span class="w">    </span><span class="n">File</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getFileForUri</span><span class="p">(</span><span class="n">uri</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">LARGE_FILE_THRESHOLD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">openLargeFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ParcelFileDescriptor</span><span class="p">.</span><span class="na">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">parseMode</span><span class="p">(</span><span class="n">mode</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>



   2. **æ–­ç‚¹ç»­ä¼ æ”¯æŒ**ï¼š
      - è§£æRangeå¤´ï¼š`bytes=start-end`
      - ä½¿ç”¨`ParcelFileDescriptor.open()`çš„offsetå‚æ•°
      - è¿”å›206 Partial ContentçŠ¶æ€

   3. **å†…å­˜ä¼˜åŒ–**ï¼š
      - ä½¿ç”¨`MemoryFile`è¿›è¡Œå†…å­˜æ˜ å°„
      - å®ç°æµå¼ä¼ è¾“ï¼Œé¿å…å…¨æ–‡ä»¶åŠ è½½
      - è®¾ç½®åˆç†çš„ç¼“å†²åŒºå¤§å°

   4. **å¹¶å‘æ§åˆ¶**ï¼š
      - è¯»æ“ä½œï¼šä½¿ç”¨å…±äº«é”
      - å†™æ“ä½œï¼šä½¿ç”¨æ’ä»–é”
      - å®ç°é”è¶…æ—¶æœºåˆ¶

   5. **æ€§èƒ½ç›‘æ§**ï¼š
      - ä¼ è¾“é€Ÿåº¦ç»Ÿè®¡
      - å¹¶å‘è¿æ¥æ•°é™åˆ¶
      - æ…¢æŸ¥è¯¢æ£€æµ‹å’Œä¼˜åŒ–
   </details>
<ol start="8">
<li><strong>ContentProviderä¸Roomé›†æˆ</strong></li>
</ol>
<p>è®¾è®¡ä¸€ä¸ªæ–¹æ¡ˆï¼Œå°†Roomæ•°æ®åº“ä¸ContentProvideré›†æˆï¼Œè¦æ±‚ï¼š</p>
<ul>
<li>ä¿ç•™Roomçš„ç±»å‹å®‰å…¨ç‰¹æ€§</li>
<li>æ”¯æŒRoomçš„å“åº”å¼æŸ¥è¯¢</li>
<li>æœ€å°åŒ–æ ·æ¿ä»£ç </li>
<li>æ”¯æŒè·¨è¿›ç¨‹æ•°æ®è§‚å¯Ÿ</li>
</ul>
<p><em>Hint: è€ƒè™‘ä»£ç ç”Ÿæˆå’Œé€‚é…å™¨æ¨¡å¼</em></p>
<details markdown="block">
   <summary markdown="off">å‚è€ƒç­”æ¡ˆ</summary>

   Roomä¸ContentProvideré›†æˆæ–¹æ¡ˆï¼š

   1. **æ¶æ„è®¾è®¡**ï¼š


<div class="codehilite"><pre><span></span><code><span class="c1">// æ³¨è§£å®šä¹‰</span>
<span class="nd">@ContentProviderEntity</span><span class="p">(</span>
<span class="w">    </span><span class="n">authority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.example.provider&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;users&quot;</span>
<span class="p">)</span>
<span class="nd">@Entity</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">User</span><span class="p">(</span>
<span class="w">    </span><span class="nd">@PrimaryKey</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Long</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">email</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span>
<span class="p">)</span>
</code></pre></div>



   2. **è‡ªåŠ¨ç”Ÿæˆçš„Provider**ï¼š


<div class="codehilite"><pre><span></span><code><span class="nd">@Generated</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UserContentProvider</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">ContentProvider</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UserDao</span><span class="w"> </span><span class="n">userDao</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Cursor</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="n">Uri</span><span class="w"> </span><span class="n">uri</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// å°†RoomæŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºCursor</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">userDao</span><span class="p">.</span><span class="na">getUsers</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">UserCursorWrapper</span><span class="p">.</span><span class="na">wrap</span><span class="p">(</span><span class="n">users</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



   3. **å“åº”å¼æŸ¥è¯¢æ”¯æŒ**ï¼š


<div class="codehilite"><pre><span></span><code><span class="c1">// æä¾›LiveDataåŒ…è£…</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">observeUsers</span><span class="p">(</span><span class="n">contentResolver</span><span class="p">:</span><span class="w"> </span><span class="n">ContentResolver</span><span class="p">):</span><span class="w"> </span><span class="n">LiveData</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ContentProviderLiveData</span><span class="p">(</span>
<span class="w">        </span><span class="n">contentResolver</span><span class="p">,</span>
<span class="w">        </span><span class="n">Uri</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="s">&quot;content://com.example.provider/users&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">).</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">cursor</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">        </span><span class="n">cursor</span><span class="p">.</span><span class="na">toUserList</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>



   4. **è·¨è¿›ç¨‹è§‚å¯Ÿæœºåˆ¶**ï¼š
      - Roomè§¦å‘å™¨è‡ªåŠ¨è°ƒç”¨`notifyChange()`
      - ContentObserverè½¬æ¢ä¸ºLiveData/Flow
      - æ‰¹é‡æ›´æ–°ä¼˜åŒ–ï¼Œå‡å°‘é€šçŸ¥é¢‘ç‡

   5. **ç±»å‹å®‰å…¨ä¿è¯**ï¼š
      - ç¼–è¯‘æ—¶URIéªŒè¯
      - è‡ªåŠ¨ç”Ÿæˆçš„æŠ•å½±(projection)å¸¸é‡
      - ç±»å‹å®‰å…¨çš„æŸ¥è¯¢æ„å»ºå™¨
   </details>
<h2 id="gotchas">å¸¸è§é™·é˜±ä¸é”™è¯¯ (Gotchas)</h2>
<ol>
<li>
<p><strong>Providerè¿›ç¨‹å¯åŠ¨å»¶è¿Ÿ</strong>
   - é—®é¢˜ï¼šé¦–æ¬¡è®¿é—®Provideræ—¶å¯èƒ½æœ‰æ˜¾è‘—å»¶è¿Ÿ
   - è§£å†³ï¼šåœ¨Providerä¸­é¿å…é‡é‡çº§åˆå§‹åŒ–ï¼Œä½¿ç”¨æ‡’åŠ è½½</p>
</li>
<li>
<p><strong>Cursoræ³„éœ²</strong>
   - é—®é¢˜ï¼šæœªå…³é—­Cursorå¯¼è‡´å†…å­˜æ³„éœ²å’Œæ–‡ä»¶æè¿°ç¬¦è€—å°½
   - è§£å†³ï¼šä½¿ç”¨try-with-resourcesæˆ–ç¡®ä¿åœ¨finallyå—ä¸­å…³é—­</p>
</li>
<li>
<p><strong>è·¨è¿›ç¨‹å¤§æ•°æ®ä¼ è¾“</strong>
   - é—®é¢˜ï¼šè¶…è¿‡CursorWindowé™åˆ¶å¯¼è‡´å¼‚å¸¸
   - è§£å†³ï¼šå®ç°åˆ†é¡µæŸ¥è¯¢ï¼Œé™åˆ¶å•æ¬¡è¿”å›æ•°æ®é‡</p>
</li>
<li>
<p><strong>URIæƒé™æ··æ·†</strong>
   - é—®é¢˜ï¼šä¸´æ—¶æƒé™ç®¡ç†ä¸å½“å¯¼è‡´æƒé™æ³„éœ²æˆ–æ— æ³•è®¿é—®
   - è§£å†³ï¼šæ˜ç¡®æƒé™ç”Ÿå‘½å‘¨æœŸï¼ŒåŠæ—¶æ’¤é”€ä¸éœ€è¦çš„æƒé™</p>
</li>
<li>
<p><strong>é€šçŸ¥é£æš´</strong>
   - é—®é¢˜ï¼šé¢‘ç¹çš„æ•°æ®æ›´æ–°å¯¼è‡´è¿‡å¤šé€šçŸ¥
   - è§£å†³ï¼šå®ç°é€šçŸ¥åˆå¹¶æœºåˆ¶ï¼Œæ‰¹é‡æ“ä½œä½¿ç”¨äº‹åŠ¡</p>
</li>
<li>
<p><strong>SQLæ³¨å…¥æ¼æ´</strong>
   - é—®é¢˜ï¼šç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥åˆ°SQLè¯­å¥
   - è§£å†³ï¼šå§‹ç»ˆä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ŒéªŒè¯è¾“å…¥</p>
</li>
<li>
<p><strong>å¹¶å‘ä¿®æ”¹é—®é¢˜</strong>
   - é—®é¢˜ï¼šå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶ä¿®æ”¹æ•°æ®å¯¼è‡´ä¸ä¸€è‡´
   - è§£å†³ï¼šä½¿ç”¨ä¹è§‚é”æˆ–æ•°æ®åº“äº‹åŠ¡</p>
</li>
<li>
<p><strong>Provider exportedè¯¯é…ç½®</strong>
   - é—®é¢˜ï¼šæ•æ„Ÿæ•°æ®Providerè¢«æ„å¤–æš´éœ²
   - è§£å†³ï¼šé»˜è®¤exported=falseï¼Œæ˜ç¡®éœ€è¦æ—¶æ‰è®¾ç½®ä¸ºtrue</p>
</li>
</ol>
<h2 id="_6">æœ€ä½³å®è·µæ£€æŸ¥æ¸…å•</h2>
<h3 id="_7">è®¾è®¡é˜¶æ®µ</h3>
<ul>
<li>[ ] URIç»“æ„è®¾è®¡åˆç†ï¼Œéµå¾ªRESTfulåŸåˆ™</li>
<li>[ ] æƒé™æ¨¡å‹æ»¡è¶³æœ€å°æƒé™åŸåˆ™</li>
<li>[ ] è€ƒè™‘äº†æ•°æ®é‡å’Œæ€§èƒ½éœ€æ±‚</li>
<li>[ ] è®¾è®¡äº†åˆé€‚çš„ç¼“å­˜ç­–ç•¥</li>
<li>[ ] è§„åˆ’äº†ç‰ˆæœ¬å‡çº§å’Œå…¼å®¹æ€§æ–¹æ¡ˆ</li>
</ul>
<h3 id="_8">å®ç°é˜¶æ®µ</h3>
<ul>
<li>[ ] æ‰€æœ‰æ•°æ®åº“æ“ä½œä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢</li>
<li>[ ] å®ç°äº†é€‚å½“çš„è¾“å…¥éªŒè¯</li>
<li>[ ] å¤§æ•°æ®æŸ¥è¯¢å®ç°äº†åˆ†é¡µ</li>
<li>[ ] æ‰¹é‡æ“ä½œä½¿ç”¨äº‹åŠ¡</li>
<li>[ ] æ­£ç¡®å¤„ç†äº†Providerç”Ÿå‘½å‘¨æœŸ</li>
</ul>
<h3 id="_9">å®‰å…¨æ£€æŸ¥</h3>
<ul>
<li>[ ] exportedå±æ€§è®¾ç½®æ­£ç¡®</li>
<li>[ ] æƒé™å£°æ˜ç¬¦åˆéœ€æ±‚</li>
<li>[ ] å®ç°äº†è°ƒç”¨è€…èº«ä»½éªŒè¯</li>
<li>[ ] æ•æ„Ÿæ•°æ®å·²åŠ å¯†</li>
<li>[ ] æœ‰å®Œå–„çš„å®¡è®¡æ—¥å¿—</li>
</ul>
<h3 id="_10">æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>[ ] æ•°æ®åº“æŸ¥è¯¢å·²ä¼˜åŒ–ï¼ˆç´¢å¼•ã€æŸ¥è¯¢è®¡åˆ’ï¼‰</li>
<li>[ ] å®ç°äº†æŸ¥è¯¢ç»“æœç¼“å­˜</li>
<li>[ ] å¤§æ–‡ä»¶ä½¿ç”¨æµå¼ä¼ è¾“</li>
<li>[ ] é€šçŸ¥æœºåˆ¶é¿å…äº†é£æš´</li>
<li>[ ] ç›‘æ§äº†å…³é”®æ€§èƒ½æŒ‡æ ‡</li>
</ul>
<h3 id="_11">æµ‹è¯•è¦†ç›–</h3>
<ul>
<li>[ ] å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘</li>
<li>[ ] é›†æˆæµ‹è¯•éªŒè¯è·¨è¿›ç¨‹åœºæ™¯</li>
<li>[ ] å‹åŠ›æµ‹è¯•éªŒè¯æ€§èƒ½</li>
<li>[ ] å®‰å…¨æµ‹è¯•éªŒè¯æƒé™æ§åˆ¶</li>
<li>[ ] å…¼å®¹æ€§æµ‹è¯•è¦†ç›–ç›®æ ‡ç‰ˆæœ¬</li>
</ul>
            </article>
            
            <nav class="page-nav"><a href="chapter8.html" class="nav-link prev">â† ç¬¬8ç« ï¼šç³»ç»ŸæœåŠ¡æ¶æ„</a><a href="chapter10.html" class="nav-link next">ç¬¬10ç« ï¼šAndroidå›¾å½¢ç³»ç»Ÿæ¶æ„ â†’</a></nav>
        </main>
    </div>
</body>
</html>